---
paths:
  - "src/i18n/**/*"
  - "src/components/**/*.tsx"
  - "app/**/*.tsx"
---

# i18n Rules (Internationalization)

## Core Principle

**ハードコード日本語禁止**: 全てのユーザー向けテキストは `t()` を使用する

```typescript
// ✅ Good
import { t } from '@/i18n';
<Text>{t('common.save')}</Text>

// ❌ Bad
<Text>保存</Text>
```

## File Structure

```
src/i18n/
  index.ts          # i18n setup, t() helper export
  locales/
    ja.json         # Japanese translations (default)
    en.json         # English translations (future)
```

## Translation Key Structure

### Namespace Convention
```json
{
  "common": {          // App-wide common strings
    "save": "保存",
    "cancel": "キャンセル"
  },
  "onboarding": {      // Feature namespace
    "welcome": {       // Screen/section
      "title": "ようこそ",
      "subtitle": "説明文..."
    }
  },
  "home": { },         // Main screens
  "settings": { },
  "errors": { }        // Error messages
}
```

### Key Naming Rules

| Pattern | Example | Usage |
|---------|---------|-------|
| `namespace.key` | `common.save` | Simple strings |
| `namespace.section.key` | `onboarding.welcome.title` | Grouped by screen |
| `namespace.item.property` | `intervention.types.mirror` | Enumerable items |

## Usage Patterns

### Basic Translation
```typescript
import { t } from '@/i18n';

const MyComponent = () => (
  <Text>{t('screen.title')}</Text>
);
```

### With Interpolation
```json
{
  "greeting": "こんにちは、{{name}}さん",
  "count": "{{count}}件の通知"
}
```
```typescript
t('greeting', { name: userName })
t('count', { count: 5 })
```

### Pluralization
```json
{
  "items": {
    "zero": "アイテムなし",
    "one": "1件のアイテム",
    "other": "{{count}}件のアイテム"
  }
}
```
```typescript
t('items', { count: items.length })
```

## Adding New Translations

### Step 1: Add to ja.json
```json
{
  "newFeature": {
    "title": "新機能",
    "description": "説明文"
  }
}
```

### Step 2: Use in Component
```typescript
import { t } from '@/i18n';

<Text>{t('newFeature.title')}</Text>
```

## Prohibited Patterns

| Prohibited | Reason | Fix |
|------------|--------|-----|
| Inline Japanese | Not localizable | Use `t()` |
| Template literals with text | Hard to extract | Use interpolation |
| Concatenating translations | Word order varies | Single key with params |
| Long keys | Hard to read | Max 3 levels deep |

### Concatenation Example
```typescript
// ❌ Bad: Concatenation
t('you.have') + ' ' + count + ' ' + t('messages')

// ✅ Good: Single key with interpolation
t('notification.messageCount', { count })
```

## Special Cases

### Accessibility Labels
```typescript
<TouchableOpacity
  accessibilityLabel={t('button.save.accessibility')}
>
```

### Error Messages
```json
{
  "errors": {
    "network": "ネットワークに接続できません",
    "validation": {
      "required": "{{field}}は必須です",
      "minLength": "{{field}}は{{min}}文字以上必要です"
    }
  }
}
```

### Dynamic Content
For content that comes from API/database, don't translate - display as-is.

```typescript
// User-generated content: no translation
<Text>{post.title}</Text>

// App UI: always translate
<Text>{t('post.likeCount', { count: post.likes })}</Text>
```

## Checklist for New Screens

- [ ] All visible text uses `t()`
- [ ] Keys added to `ja.json`
- [ ] Keys follow namespace convention
- [ ] Interpolation for dynamic values
- [ ] Accessibility labels translated
- [ ] Error messages translated
- [ ] No hardcoded Japanese strings

## Testing Translations

```typescript
// Check for missing translations in dev
if (__DEV__) {
  const translation = t('some.key');
  if (translation.startsWith('[missing')) {
    console.warn('Missing translation:', translation);
  }
}
```
